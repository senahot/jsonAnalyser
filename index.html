<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Analyser - Query JSON Data</title>
    <link rel="stylesheet" href="css/theme.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <h1>üîç JSON Analyser</h1>
                <p class="tagline">Query and analyze JSON data in your browser</p>
            </div>
            <div class="header-actions">
                <button id="themeToggle" class="btn btn-icon" title="Toggle Theme">
                    üåô
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Left Panel: JSON Input -->
            <section class="panel input-panel">
                <div class="panel-header">
                    <h2>JSON Input</h2>
                    <div class="panel-actions">
                        <button id="uploadBtn" class="btn btn-secondary" title="Upload JSON file">
                            üìÅ Upload File
                        </button>
                        <input type="file" id="fileInput" accept=".json" hidden>
                        <button id="formatBtn" class="btn btn-secondary" title="Format JSON">
                            ‚ú® Format
                        </button>
                        <button id="clearInputBtn" class="btn btn-secondary" title="Clear input">
                            üóëÔ∏è Clear
                        </button>
                    </div>
                </div>

                <div class="panel-body">
                    <div class="editor-container">
                        <textarea
                            id="jsonInput"
                            class="json-editor"
                            placeholder='Enter or paste your JSON here...

Example:
[
  {
    "name": "John Doe",
    "age": 30,
    "email": "john@example.com",
    "status": "active"
  },
  {
    "name": "Jane Smith",
    "age": 25,
    "email": "jane@example.com",
    "status": "inactive"
  }
]'
                            spellcheck="false"
                        ></textarea>
                    </div>

                    <div id="jsonError" class="error-message hidden"></div>

                    <div class="input-stats">
                        <span id="jsonStats" class="stats-text"></span>
                    </div>
                </div>
            </section>

            <!-- Right Panel: Query & Results -->
            <section class="panel output-panel">
                <!-- Query Section -->
                <div class="panel-header">
                    <h2>Query</h2>
                    <div class="panel-actions">
                        <!-- Mode Toggle -->
                        <div class="mode-toggle">
                            <button id="codeMode" class="mode-btn active" title="Code mode">
                                üíª Code
                            </button>
                            <button id="builderMode" class="mode-btn" title="Visual builder">
                                üîß Builder
                            </button>
                        </div>
                        <select id="exampleQuerySelect" class="form-select" style="max-width: 200px;">
                            <option value="">Load Example...</option>
                        </select>
                        <button id="executeQueryBtn" class="btn btn-primary" title="Execute query">
                            ‚ñ∂Ô∏è Run
                        </button>
                        <button id="clearQueryBtn" class="btn btn-secondary" title="Clear query">
                            üóëÔ∏è Clear
                        </button>
                    </div>
                </div>

                <!-- Code Mode (Default) -->
                <div id="codeView" class="panel-body query-section">
                    <div class="query-input-container">
                        <textarea
                            id="queryInput"
                            class="query-editor"
                            placeholder='Enter JMESPath query...

Examples:
@ - Get all data
[*].name - Get all names
[?age > `25`] - Filter by age
length(@) - Count items

Try selecting an example from the dropdown above!'
                            spellcheck="false"
                        ></textarea>
                    </div>

                    <div id="queryError" class="error-message hidden"></div>

                    <div class="query-info">
                        <span class="info-link">
                            üìñ <a href="https://jmespath.org/tutorial.html" target="_blank" rel="noopener">JMESPath Tutorial</a>
                        </span>
                    </div>
                </div>

                <!-- Builder Mode (Visual) -->
                <div id="builderView" class="panel-body query-section hidden">
                    <div class="builder-container">
                        <!-- Operation Selector -->
                        <div class="builder-section">
                            <label class="builder-label">Operation</label>
                            <select id="builderOperation" class="form-select">
                                <option value="select">Select Fields</option>
                                <option value="filter">Filter Data</option>
                                <option value="count">Count Items</option>
                                <option value="sort">Sort Data</option>
                                <option value="complex">Complex Query</option>
                            </select>
                        </div>

                        <!-- Fields Section (for Select) -->
                        <div id="fieldsSection" class="builder-section">
                            <label class="builder-label">Fields to Select</label>
                            <div id="fieldsContainer" class="fields-container"></div>
                            <button id="addFieldBtn" class="btn btn-secondary btn-sm">
                                ‚ûï Add Field
                            </button>
                        </div>

                        <!-- Filters Section (for Filter & Count) -->
                        <div id="filtersSection" class="builder-section hidden">
                            <label class="builder-label">Filter Conditions</label>
                            <div id="filtersContainer" class="filters-container"></div>
                            <button id="addFilterBtn" class="btn btn-secondary btn-sm">
                                ‚ûï Add Filter
                            </button>
                        </div>

                        <!-- Sort Section (for Sort) -->
                        <div id="sortSection" class="builder-section hidden">
                            <label class="builder-label">Sort By</label>
                            <div class="sort-controls">
                                <select id="sortField" class="form-select">
                                    <option value="">Select field...</option>
                                </select>
                                <select id="sortDirection" class="form-select">
                                    <option value="asc">Ascending</option>
                                    <option value="desc">Descending</option>
                                </select>
                            </div>
                        </div>

                        <!-- Query Preview -->
                        <div class="builder-section query-preview-section">
                            <label class="builder-label">Generated Query</label>
                            <div class="query-preview-container">
                                <code id="queryPreview" class="query-preview">@</code>
                            </div>
                            <button id="buildQueryBtn" class="btn btn-primary btn-sm">
                                ‚ú® Apply Query
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Results Section -->
                <div class="panel-header">
                    <h2>Query Results</h2>
                    <div class="panel-actions">
                        <button id="copyResultsBtn" class="btn btn-secondary" title="Copy results" disabled>
                            üìã Copy
                        </button>
                    </div>
                </div>

                <div class="panel-body">
                    <div id="resultsContainer" class="output-container">
                        <div class="placeholder-message">
                            <p>üí° Enter a JMESPath query above to see results</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <p>
                JSON Analyser v0.3 | Week 3: Visual Query Builder |
                <span id="projectStatus">Build queries visually or with code!</span>
            </p>
        </footer>
    </div>

    <!-- JMESPath Library -->
    <script src="https://cdn.jsdelivr.net/npm/jmespath@0.16.0/jmespath.min.js"></script>

    <!-- JavaScript Modules -->
    <script type="module" src="js/app.js"></script>
</body>
</html>
